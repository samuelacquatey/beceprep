<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ClassMaster - Analytics Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/dashboard-modern.css">
  <link rel="stylesheet" href="css/nav.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@1.0.1/dist/driver.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/driver.js@1.0.1/dist/driver.js.iife.js"></script>
  <link rel="stylesheet" href="css/transitions.css">
  <script src="js/transitions.js" defer></script>
</head>

<body>
  <!-- Header -->

  <nav class="app-top-bar">
    <div class="brand">
      <div class="logo">CM</div>
      <div class="brand-text">
        <h1>ClassMaster</h1>
      </div>
    </div>
  </nav>

  <div class="dashboard-container">
    <!-- 2. Main Content -->
    <main class="main-content">
      <!-- Header Removed: Now using Top Bar -->
      <div style="display:flex; justify-content:space-between; margin-bottom: 20px; align-items:center;">
        <h1 style="font-size:24px; font-weight:700;">Dashboard</h1>
        <div style="display:flex; gap:10px;">
          <button id="backToQuiz" class="btn btn-primary">üìù Take Quiz</button>
        </div>
      </div>

      <!-- Top Row: Metrics (Pastel Cards) -->
      <section class="metrics-grid">
        <!-- Green Card: Study Time -->
        <div class="metric-card green">
          <div style="display:flex; justify-content:space-between;">
            <div class="card-icon"><i class="fas fa-microphone-alt"></i></div>
            <div class="card-title">Study Time</div>
          </div>
          <div>
            <div class="card-value" id="studyTime">00:00</div>
            <div class="card-trend trend-up" id="timeTrend">‚Üó +2.5 hrs</div>
          </div>
          <!-- Hidden logic element usually, but mapped here visually -->
        </div>

        <!-- Orange Card: BECE Readiness -->
        <div class="metric-card orange">
          <div style="display:flex; justify-content:space-between;">
            <div class="card-icon"><i class="fas fa-chart-line"></i></div>
            <div class="card-title">Exam Readiness</div>
          </div>
          <div style="display:flex; align-items:center; justify-content:space-between; width:100%; gap: 15px;">
            <div>
              <div class="card-value" id="mainReadinessValue">0%</div>
              <div class="card-trend" id="readinessTrend">Calculating...</div>
            </div>
            <!-- Visual Ring -->
            <div style="position:relative; width: 60px; height: 60px; flex-shrink: 0;">
              <svg class="progress-ring" width="60" height="60" style="overflow: visible;">
                <circle stroke="rgba(0,0,0,0.1)" stroke-width="4" fill="transparent" r="26" cx="30" cy="30" />
                <circle id="progressCircle" stroke="#FF9500" stroke-width="4" fill="transparent" r="26" cx="30" cy="30"
                  stroke-dasharray="163" stroke-dashoffset="163"
                  style="transition: stroke-dashoffset 1s; transform: rotate(-90deg); transform-origin: 30px 30px;" />
              </svg>
              <div
                style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); font-size:12px; font-weight:bold;"
                id="miniReadinessValue">0</div>
            </div>
          </div>
        </div>

        <!-- Yellow Card: Total Courses/Quizzes -->
        <div class="metric-card yellow">
          <div style="display:flex; justify-content:space-between;">
            <div class="card-icon"><i class="fas fa-clock"></i></div>
            <div class="card-title">Total Quizzes</div>
          </div>
          <div>
            <div class="card-value" id="totalQuestions">04</div>
            <div class="card-trend" id="questionsTrend">4 Credit</div>
          </div>
          <div style="display:none" id="studyStreak"></div> <!-- Hidden preservations -->
          <div style="display:none" id="streakTrend"></div>
        </div>
      </section>

      <!-- Middle Row: Charts & Lists -->
      <section class="middle-grid">
        <!-- Big Graph -->
        <div class="content-card">
          <div class="section-title">
            <span>Activity Hours (Last 7 Days)</span>
          </div>
          <div class="chart-wrapper">
            <canvas id="performanceChart"></canvas>
          </div>
        </div>

        <!-- Focus Areas Checklist -->
        <div class="content-card">
          <div class="section-title">
            <span>Assignments</span> <!-- "Focus Areas" mapped to "Assignment" UI slot -->
          </div>
          <div id="weakAreasList" style="display: flex; flex-direction: column; gap: 10px;">
            <!-- Populated by JS -->
          </div>
        </div>
      </section>

      <!-- Bottom Row: Recent Activity -->
      <section class="content-card">
        <div class="section-title">
          <span>Time Schedule</span> <!-- "Recent Activity" mapped to "Time Schedule" UI slot -->
          <button class="btn btn-ghost" style="font-size:12px;">See All</button>
        </div>
        <div id="activityTimeline" class="timeline-container">
          <!-- Populated by JS -->
        </div>
      </section>
    </main>

    <!-- 3. Right Panel -->
    <!--the right panel has been removed-->
  </div>

  <!-- Navigation Injection -->
  <nav class="app-nav">
    <a href="quiz.html" class="nav-item" id="nav-home">
      <div class="nav-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
          class="outline-icon">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="solid-icon">
          <path
            d="M11.47 3.841a.75.75 0 0 1 1.06 0l8.69 8.69a.75.75 0 1 0 1.06-1.061l-8.689-8.69a2.25 2.25 0 0 0-3.182 0l-8.69 8.69a.75.75 0 1 0 1.061 1.06l8.69-8.69Z" />
          <path
            d="M12 5.432 2.625 14.807v6.068a2.625 2.625 0 0 0 2.625 2.625h13.5a2.625 2.625 0 0 0 2.625-2.625v-6.068L12 5.432Z" />
        </svg>
      </div>
      <span>Home</span>
    </a>
    <a href="dashboard.html" class="nav-item active" id="nav-analytics">
      <div class="nav-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
          class="outline-icon">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M3.75 3v11.25A2.25 2.25 0 0 0 6 16.5h2.25M3.75 3h-1.5m1.5 0h16.5m0 0h1.5m-1.5 0v11.25A2.25 2.25 0 0 1 18 16.5h-2.25m-7.5 0h7.5m-7.5 0-1 3m8.5-3 1 3m0 0 .5 1.5m-.5-1.5h-9.5m0 0-.5 1.5m.75-9 3-3 2.148 2.148A12.061 12.061 0 0 1 16.5 7.605" />
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="solid-icon">
          <path fill-rule="evenodd"
            d="M2.25 13.5a8.25 8.25 0 0 1 8.25-8.25.75.75 0 0 1 .75.75v6.75H18a.75.75 0 0 1 .75.75 8.25 8.25 0 0 1-16.5 0Z"
            clip-rule="evenodd" />
          <path fill-rule="evenodd"
            d="M12.75 3a.75.75 0 0 1 .75-.75 8.25 8.25 0 0 1 8.25 8.25.75.75 0 0 1-.75.75h-7.5a.75.75 0 0 1-.75-.75V3Z"
            clip-rule="evenodd" />
        </svg>
      </div>
      <span>Analytics</span>
    </a>
    <a href="flashcards.html" class="nav-item" id="nav-flashcards">
      <div class="nav-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
          class="outline-icon">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M16.5 8.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v8.25A2.25 2.25 0 0 0 6 16.5h2.25m8.25-8.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-7.5A2.25 2.25 0 0 1 8.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 0 0-2.25 2.25v6" />
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="solid-icon">
          <path d="M11.25 3v18H6.75a2.25 2.25 0 0 1-2.25-2.25V5.25A2.25 2.25 0 0 1 6.75 3h4.5Z" />
          <path d="M12.75 3v18h4.5a2.25 2.25 0 0 0 2.25-2.25V5.25A2.25 2.25 0 0 0 17.25 3h-4.5Z" />
        </svg>
      </div>
      <span>Memorize</span>
    </a>
    <a href="social.html" class="nav-item" id="nav-social">
      <div class="nav-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
          class="outline-icon">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="solid-icon">
          <path
            d="M4.5 6.375a4.125 4.125 0 1 1 8.25 0 4.125 4.125 0 0 1-8.25 0ZM14.25 8.625a3.375 3.375 0 1 1 6.75 0 3.375 3.375 0 0 1-6.75 0ZM1.5 19.125a7.125 7.125 0 0 1 14.25 0v.003l-.001.119a.75.75 0 0 1-.363.63 13.067 13.067 0 0 1-6.761 1.873c-2.472 0-4.786-.684-6.76-1.873a.75.75 0 0 1-.364-.63l-.001-.122ZM17.25 19.128l-.001.144a2.25 2.25 0 0 1-.233.96 10.088 10.088 0 0 0 5.06-1.01.75.75 0 0 0 .42-.643 4.875 4.875 0 0 0-6.957-4.611 8.586 8.586 0 0 1 1.71 5.161Z" />
        </svg>
      </div>
      <span>Community</span>
    </a>
    <a href="profile.html" class="nav-item" id="nav-profile">
      <div class="nav-icon">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
          class="outline-icon">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="solid-icon">
          <path fill-rule="evenodd"
            d="M18.685 19.097A9.723 9.723 0 0 0 21.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 0 0 3.065 7.097A9.716 9.716 0 0 0 12 21.75a9.716 9.716 0 0 0 6.685-2.653Zm-12.54-1.285A7.486 7.486 0 0 1 12 15a7.486 7.486 0 0 1 5.855 2.812A8.224 8.224 0 0 1 12 20.25a8.224 8.224 0 0 1-5.855-2.438ZM15.75 9a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"
            clip-rule="evenodd" />
        </svg>
      </div>
      <span>Profile</span>
    </a>
  </nav>
  <script type="module">
    import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { AnalyticsEngine } from "./js/analytics.js";
    import { app, requireAuth } from "./js/auth.js";
    import { initTour } from "./js/tour.js";

    const auth = getAuth(app);

    requireAuth(async (user) => {
      await initializeDashboard(user);
      initTour('dashboard');
    });

    async function initializeDashboard(user) {
      const analytics = new AnalyticsEngine(user.uid);

      try {
        const data = await analytics.loadData(30);
        if (data.insights.length === 0) {
          showNoDataState();
          return;
        }

        const progress = analytics.calculateOverallProgress();
        const recommendations = analytics.generateRecommendations();

        // Update readiness score
        updateReadinessScore(progress.readinessScore);

        // Update quick stats
        updateQuickStats(progress);

        // Render charts
        renderPerformanceChart(analytics);
        renderSubjectChart(analytics);

        // Render weak areas
        renderWeakAreas(recommendations);

        // Render activity timeline (prefer granular history)
        const timelineData = (data.history && data.history.length > 0)
          ? data.history.slice(0, 5).reverse()
          : data.insights.slice(-5);

        renderActivityTimeline(timelineData);

      } catch (error) {
        console.error('Error loading dashboard:', error);
        showErrorState();
      }

      // Event listeners
      document.getElementById('backToQuiz').addEventListener('click', () => {
        window.location.href = 'quiz.html';
      });

      document.getElementById('backToQuiz').addEventListener('click', () => {
        window.location.href = 'quiz.html';
      });

      // document.getElementById('logoutBtn').addEventListener('click', () => {
      //   signOut(auth).then(() => window.location.href = 'login.html');
      // });
    }

    function updateReadinessScore(score) {
      const mainValueEl = document.getElementById('mainReadinessValue');
      const miniValueEl = document.getElementById('miniReadinessValue');
      const trendEl = document.getElementById('readinessTrend');
      const circle = document.getElementById('progressCircle');

      // Animate Main Counter
      animateCounter(mainValueEl, 0, score, 2000);

      // Update Mini Value
      miniValueEl.textContent = score; // No % needed inside small circle if tight

      // Update Circle Ring
      const circumference = 2 * Math.PI * 85; // This seems large for r=26? 
      // r=26 -> circumference = 2 * PI * 26 ‚âà 163. Updated to match SVG.
      const realCircum = 163;
      const offset = realCircum - (score / 100) * realCircum;
      circle.style.strokeDasharray = realCircum;
      circle.style.strokeDashoffset = offset;

      // Update Trend / Message
      if (score >= 80) {
        trendEl.textContent = "üéâ Exam Ready!";
        trendEl.className = "card-trend trend-up";
        circle.style.stroke = '#10B981';
      } else if (score >= 60) {
        trendEl.textContent = "üëç On Track";
        trendEl.className = "card-trend trend-up";
        circle.style.stroke = '#06B6D4';
      } else {
        trendEl.textContent = "üí™ Needs Work";
        trendEl.className = "card-trend trend-down";
        circle.style.stroke = '#F59E0B';
      }
    }

    function updateQuickStats(progress) {
      document.getElementById('totalQuestions').textContent = progress.totalQuestions;
      // Removed avgAccuracy from Quick Stats as it's now replaced by Readiness
      // document.getElementById('avgAccuracy').textContent = progress.accuracy + '%';

      document.getElementById('studyStreak').textContent = (progress.consistencyScore > 70 ? '7+' : '3') + ' days';
      document.getElementById('studyTime').textContent = (progress.totalStudyTime / 60).toFixed(1) + ' hrs';

      // Add trend indicators
      document.getElementById('questionsTrend').textContent = '‚Üó +12 this week';
      // document.getElementById('accuracyTrend').textContent = progress.accuracy > 70 ? '‚Üó +5%' : '‚Üí Stable';
      document.getElementById('streakTrend').textContent = 'üî• Keep it up!';
      document.getElementById('timeTrend').textContent = '‚Üó +2.3 hrs';
    }

    function renderPerformanceChart(analytics) {
      const ctx = document.getElementById('performanceChart').getContext('2d');

      // Generate last 7 days explicitly to ensure continuous timeline
      const labels = [];
      const dataPoints = [];
      const statsMap = {};

      // Index available data by date string
      analytics.insights.forEach(d => {
        statsMap[new Date(d.date).toLocaleDateString()] = d;
      });

      // iterate from 6 days ago to today
      for (let i = 6; i >= 0; i--) {
        const d = new Date();
        d.setDate(d.getDate() - i);
        const dateStr = d.toLocaleDateString();

        labels.push(d.toLocaleDateString('en-US', { weekday: 'short' }));

        if (statsMap[dateStr]) {
          dataPoints.push(Math.round((statsMap[dateStr].timeSpent || 0) / 60));
        } else {
          dataPoints.push(0); // Fill missing days with 0
        }
      }

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Minutes Studied',
            data: dataPoints,
            borderColor: '#2563EB', // Brand accent
            backgroundColor: 'rgba(37, 99, 235, 0.1)', // Light fill
            fill: true,
            tension: 0.4, // Smooth curve
            borderWidth: 3,
            pointRadius: 4,
            pointBackgroundColor: '#2563EB',
            pointBorderColor: '#fff',
            pointBorderWidth: 2,
            pointHoverRadius: 6
          }]
        },
        options: {
          resizeDelay: 0, // Fix resize flicker
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: '#1E293B',
              padding: 12,
              titleColor: '#fff',
              bodyColor: '#fff',
              displayColors: false,
              callbacks: {
                label: function (context) {
                  return context.raw + ' mins';
                }
              }
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              grace: '20%', // Add breathing room at top
              grid: {
                color: '#F3F4F6',
                drawBorder: false,
                borderDash: [5, 5]
              },
              ticks: {
                color: '#9CA3AF',
                font: { size: 11 }
              },
              border: { display: false }
            },
            x: {
              grid: { display: false },
              ticks: {
                color: '#6B7280',
                font: { size: 12, weight: '500' }
              },
              border: { display: false }
            }
          }
        }
      });
    }

    function renderSubjectChart(analytics) {
      const canvas = document.getElementById('subjectChart');
      if (!canvas) return;

      const ctx = canvas.getContext('2d');
      const subjects = {};

      Object.values(analytics.topicPerformance).forEach(t => {
        if (!subjects[t.subject]) subjects[t.subject] = { total: 0, correct: 0 };
        subjects[t.subject].total += t.total;
        subjects[t.subject].correct += t.correct;
      });

      const labels = Object.keys(subjects);
      const data = labels.map(s => (subjects[s].correct / subjects[s].total) * 100);

      new Chart(ctx, {
        type: 'radar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Mastery',
            data: data,
            borderColor: '#06B6D4',
            backgroundColor: 'rgba(6, 182, 212, 0.2)',
            borderWidth: 2,
            pointRadius: 4,
            pointBackgroundColor: '#06B6D4',
            pointBorderColor: '#fff',
            pointBorderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            r: {
              beginAtZero: true,
              max: 100,
              grid: { color: '#E5E7EB' },
              angleLines: { color: '#E5E7EB' },
              pointLabels: { color: '#1E293B', font: { size: 12, weight: '600' } },
              ticks: { display: false }
            }
          },
          plugins: { legend: { display: false } }
        }
      });
    }

    function renderWeakAreas(recommendations) {
      const container = document.getElementById('weakAreasList');
      const weakAreas = recommendations.filter(r => r.priority === 'high' || r.priority === 'medium').slice(0, 5);

      if (weakAreas.length === 0) {
        container.innerHTML = '<div class="no-data">üéâ Great job! No weak areas detected.</div>';
        return;
      }

      container.innerHTML = weakAreas.map(area => {
        let foundationsHtml = '';
        if (area.foundations && area.foundations.length > 0) {
          foundationsHtml = `
                  <div style="margin-top:8px;">
                      <span style="font-size:11px; color:#6b7280; font-weight:600;">PREREQUISITES:</span>
                      <div style="display:flex; gap:5px; flex-wrap:wrap; margin-top:4px;">
                          ${area.foundations.map(f => `<span style="background:#f3f4f6; color:#4b5563; padding:2px 8px; border-radius:4px; font-size:11px;">${f}</span>`).join('')}
                      </div>
                  </div>`;
        }

        return `
            <div class="weak-area-item ${area.priority}">
              <div class="weak-area-header">
                <span class="priority-badge ${area.priority}">${area.priority.toUpperCase()}</span>
                <h4>${area.title}</h4>
              </div>
              <p>${area.message}</p>
              <div class="action-tip">üí° ${area.action}</div>
              ${foundationsHtml}
            </div>
          `;
      }).join('');
    }

    function renderActivityTimeline(recentInsights) {
      const container = document.getElementById('activityTimeline');

      if (recentInsights.length === 0) {
        container.innerHTML = '<div class="no-data">No recent activity</div>';
        return;
      }

      container.innerHTML = recentInsights.reverse().map(insight => {
        const total = insight.totalQuestions || 0;
        const correct = insight.correctAnswers !== undefined ? insight.correctAnswers : (insight.correctCount || 0);
        const accuracy = total > 0 ? Math.round((correct / total) * 100) : 0;
        const icon = accuracy >= 70 ? '‚úÖ' : accuracy >= 50 ? '‚ö†Ô∏è' : '‚ùå';

        return `
          <div class="timeline-item">
            <div class="timeline-icon">${icon}</div>
            <div class="timeline-content">
              <div class="timeline-header">
                <h4>${insight.mode ? (insight.mode === 'practice' ? 'Practice Quiz' : 'Exam Simulation') : 'Quiz Session'}</h4>
                <span class="timeline-date">${new Date(insight.date).toLocaleDateString()}</span>
              </div>
              <p>${correct}/${total} correct (${accuracy}%)</p>
            </div>
          </div>
        `;
      }).join('');
    }

    function animateCounter(element, start, end, duration) {
      const range = end - start;
      const increment = range / (duration / 16);
      let current = start;

      const timer = setInterval(() => {
        current += increment;
        if (current >= end) {
          element.textContent = Math.round(end) + '%';
          clearInterval(timer);
        } else {
          element.textContent = Math.round(current) + '%';
        }
      }, 16);
    }

    function showNoDataState() {
      // FIX: .container does not exist, use .main-content to preserve sidebar or .dashboard-container to wipe all
      const container = document.querySelector('.main-content') || document.querySelector('.dashboard-container');

      if (container) {
        container.innerHTML = `
          <div class="no-data-state" style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:100%; text-align:center; padding: 2rem;">
            <div class="no-data-icon" style="font-size: 3rem; margin-bottom: 1rem;">üìä</div>
            <h2>No Data Available Yet</h2>
            <p style="color: grey; margin-bottom: 2rem;">Taking quizzes requires an internet connection to sync your specialized analytics.</p>
            <button class="btn btn-primary" onclick="window.location.href='quiz.html'">Take a Quiz Now</button>
          </div>
        `;
      }
    }

    function showErrorState() {
      const container = document.querySelector('.main-content') || document.querySelector('.dashboard-container');

      if (container) {
        container.innerHTML = `
          <div class="no-data-state" style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:100%; text-align:center; padding: 2rem;">
            <div class="no-data-icon" style="font-size: 3rem; margin-bottom: 1rem;">‚ö†Ô∏è</div>
            <h2>Connection Issue</h2>
            <p style="color: grey; margin-bottom: 2rem;">We couldn't load your innovative analytics. Please check your internet.</p>
            <button class="btn btn-primary" onclick="location.reload()">Retry Connection</button>
          </div>
        `;
      }
    }
  </script>
</body>

</html>